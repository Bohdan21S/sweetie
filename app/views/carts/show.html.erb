<h1>Ваша корзина</h1>

<% if @cart_items.any? %>
  <table>
    <thead>
    <tr>
      <th>Назва</th>
      <th>Ціна</th>
      <th>Кількість</th>
      <th>Разом</th>
      <th>Дія</th>
    </tr>
    </thead>
    <tbody>
    <% @cart_items.each do |item| %>
      <tr>
        <td><%= item.product.name %></td>
        <td><%= number_to_currency(item.product.price) %></td>
        <td><%= item.quantity %></td>
        <td><%= number_to_currency(item.product.price * item.quantity) %></td>
<!--        TODO change quantity-->
        <td>
          <%= button_to 'Видалити', cart_item_path(item), method: :delete, data: { confirm: 'Ви впевнені?' } %>
        </td>
      </tr>
    <% end %>
    </tbody>
  </table>

  <p><strong>Загальна сума: <%= number_to_currency(@cart_items.sum { |item| item.product.price * item.quantity }) %></strong></p>
<% else %>
  <p>Ваша корзина порожня.</p>
<% end %>


<%# @cart_items.each do |item| %>
<!--  <tr>-->
<!--    <td><%#= item.product.name %></td>-->
<!--    <td><%#= number_to_currency(item.product.price) %></td>-->
<!--    <td>-->
      <%#= form_with url: cart_item_path(item), method: :patch, local: true do |f| %>
        <%#= button_tag('-', type: 'button', class: 'update-quantity', data: { action: 'decrease', item_id: item.id }) %>
        <%#= f.number_field :quantity, value: item.quantity, min: 1, class: 'quantity-field', data: { item_id: item.id } %>
        <%#= button_tag('+', type: 'button', class: 'update-quantity', data: { action: 'increase', item_id: item.id }) %>
        <%#= f.submit 'Оновити', style: 'display: none;' %>
      <%# end %>
<!--    </td>-->
<!--    <td><%#= number_to_currency(item.product.price * item.quantity) %></td>-->
<!--    <td>-->
      <%#= link_to 'Видалити', cart_item_path(item), method: :delete, data: { confirm: 'Ви впевнені?' } %>
<!--    </td>-->
<!--  </tr>-->
<%# end %>
